
# apache_camel_project  

#### Задача   
Есть папка с файлами.    
При помощи средств Apache Camel реализовать следующий процесс:   
файл достается из папки, далее,    
в зависимости от типа, выполняются некоторые действия.    
Если файл имеет расширение xml, то его необходимо его содержимое отправить в очередь в брокере ActiveMQ.    
Если он имеет расширение txt, то его необходимо отправить в брокер, а так же записать в таблицу в БД.    
Если расширение другое - выбрасывается исключение и отправлять файл в очередь invalid-queue в ActiveMQ.    
При обработке каждого сотого файла отсылать письмо, содержащее количество файлов txt, количество файлов xml,    
количество нераспознанных файлов, а так же время обработки пачки сообщений.    
Для гарантированной доставки следует сконфигурировать и подключить менеджер распределенных транзакций (Bitronix TM).    
Предполагаемое время решения - 10-15 ч.  

#### NOTE    
Обработка ведеться для каждого 3-го файла (при отсылке письма)
-----------------------------------------------
HOW TO USE -  

1) Скачать и запустить SMTP сервер c настройками по умолчанию -  
https://github.com/Nilhcem/FakeSMTP  
Для удобства можно создать файл для запуска.  
К примеру, такой -   
runSMTPserver.bat,  
с содержимым -  
java -jar E:\tmp\WARNING\fakeSMTP-latest\fakeSMTP-2.0.jar --output-dir E:\tmp\WARNING\mails --start-server   

2) Скачать реализацию базы данных H2 с офф сайта  
http://www.h2database.com/h2-2017-06-10.zip  
распаковать, и запустить {extract_folder_name}\h2\bin\h2w.bat (для Win)  
В отличие от "embedded" и "file" режимов "tcp" работает стабильнее.  




